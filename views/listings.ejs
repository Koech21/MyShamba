<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PLOTTOSHA | Listings</title>
  <link rel="stylesheet" href="/css/listings.css">
</head>
<body>
  <%- include('partials/navbar') %>

  <main class="container">
    <section class="search-section">
      <h1 class="title">Find Your Perfect Plot</h1>
      <input 
        type="text" 
        id="searchInput" 
        placeholder="Search by title, location, or category..." 
        class="search-bar">
      <div class="wishlist-controls" style="margin-top: 10px; display: flex; gap: 10px; align-items: center;">
        <button id="wishlistToggle" class="btn-outline">Show Wishlist</button>
        <span>Saved: <strong id="wishlistCount">0</strong></span>
      </div>
    </section>

    <section id="listingsContainer" class="listings-grid">
      <% listings.forEach(listing => { %>
        <div class="listing-card" data-id="<%= listing.id %>">
          <img src="<%= listing.image_url %>" alt="<%= listing.title %>">
          <div class="card-body">
            <h2><%= listing.title %></h2>
            <p class="location"><%= listing.location %></p>
            <p class="category"><%= listing.category %></p>
            <p class="price">Ksh <%= listing.price.toLocaleString() %></p>
            <p class="size"><%= listing.size_in_acres %> acres</p>
            <div class="card-actions">
              <button class="wishlist-btn" onclick="toggleWishlist('<%= listing.id %>')">
                ❤️ Save
              </button>
              <a href="/listing/<%= listing.id %>" class="view-btn">View Details</a>
            </div>
          </div>
        </div>
      <% }) %>
    </section>
  </main>

  <script src="/js/listings.js"></script>
  <script src="/js/main.js"></script>
</body>
</html>
